<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>PSYCHEBEND</title>
    <style>
        body {
            background-color: #000;
            color: #2ebd35;
            font-family: 'Courier New', monospace;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            padding: env(safe-area-inset-top) 0 env(safe-area-inset-bottom) 0;
            touch-action: none; /* Disables browser-level scroll for our logic */
        }

        .nav-wrapper {
            position: fixed;
            top: calc(env(safe-area-inset-top) + 20px);
            right: 25px;
            z-index: 9999;
        }
        .nav-return {
            text-decoration: none;
            color: #1a3a1d;
            font-size: 11px;
            letter-spacing: 1px;
            transition: color 0.5s;
        }
        .nav-return:hover { color: #2ebd35; }

        .video-wrapper {
            width: 90vw;
            max-width: 800px;
            position: relative;
            z-index: 5;
            /* Subtly darkened by default */
            filter: brightness(0.7) contrast(1.1);
            transition: filter 0.5s ease-out;
            will-change: transform, filter;
        }

        .player-box {
            margin-top: 30px;
            z-index: 10;
            opacity: 0.4;
            filter: grayscale(100%);
            transition: opacity 0.8s ease;
            will-change: transform;
        }

        /* Narrative fragments - purely liminal */
        .narrative {
            position: absolute;
            font-size: 10px;
            color: #0a1a0b;
            max-width: 160px;
            pointer-events: none;
            text-align: center;
            z-index: 10;
            transition: color 1s;
        }

        body:active .narrative { color: #1a4a1f; }

        /* The scanline overlay - purely visual depth */
        .overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(0,0,0,0) 50%, rgba(0,0,0,0.1) 50%);
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 100;
        }
    </style>
</head>
<body>

    <div class="overlay"></div>

    <div class="nav-wrapper">
        <a href="../index.html" class="nav-return">back_to_root</a>
    </div>

    <div class="narrative" style="top: 12%; left: 8%;">Psyche fluttering toward light,</div>
    <div class="narrative" style="bottom: 22%; right: 8%;">bend the gravity that pulls her back.</div>

    <div class="video-wrapper" id="monolith">
        <div style="padding:56.25% 0 0 0;position:relative;">
            <iframe src="https://player.vimeo.com/video/1149404576?badge=0&autopause=0&player_id=0&app_id=58479&autoplay=1&muted=1&loop=1&background=1" 
                    frameborder="0" allow="autoplay; fullscreen" 
                    style="position:absolute;top:0;left:0;width:100%;height:100%;"></iframe>
        </div>
    </div>

    <div class="player-box" id="player">
        <iframe style="border: 0; width: 170px; height: 170px;" src="https://bandcamp.com/EmbeddedPlayer/track=1619387285/size=large/bgcol=333333/linkcol=2ebd35/minimal=true/transparent=true/" seamless></iframe>
    </div>

    <script>
        const monolith = document.getElementById('monolith');
        const player = document.getElementById('player');
        
        let targetX = 0, targetY = 0;
        let currentX = 0, currentY = 0;
        let startX = 0, startY = 0;

        function update() {
            // Easing / Inertia
            currentX += (targetX - currentX) * 0.08;
            currentY += (targetY - currentY) * 0.08;

            const velocity = Math.abs(targetX - currentX) + Math.abs(targetY - currentY);
            const blur = Math.min(velocity * 0.05, 4);
            const bright = 0.7 + (Math.min(velocity * 0.01, 0.3));

            monolith.style.transform = `translate(${currentX * 0.15}px, ${currentY * 0.15}px)`;
            monolith.style.filter = `brightness(${bright}) blur(${blur}px)`;
            
            player.style.transform = `translate(${currentX * 0.05}px, ${currentY * 0.05}px)`;

            requestAnimationFrame(update);
        }

        // DESKTOP: Wheel / Scroll
        window.addEventListener('wheel', (e) => {
            targetX -= e.deltaX * 0.5;
            targetY -= e.deltaY * 0.5;
            
            // Auto-return to center
            clearTimeout(window.snapTimer);
            window.snapTimer = setTimeout(() => { targetX = 0; targetY = 0; }, 100);
        }, { passive: true });

        // MOBILE: Touch
        document.addEventListener('touchstart', (e) => {
            startX = e.touches[0].clientX;
            startY = e.touches[0].clientY;
        }, { passive: true });

        document.addEventListener('touchmove', (e) => {
            targetX = e.touches[0].clientX - startX;
            targetY = e.touches[0].clientY - startY;
        }, { passive: true });

        document.addEventListener('touchend', () => {
            targetX = 0;
            targetY = 0;
        });

        update();
    </script>
</body>
</html>