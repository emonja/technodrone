<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ROOT://SEQUENCER_CONSOLE</title>

<style>
body{
    background:#000;
    color:#444;
    font-family:'Courier New',monospace;
    padding:30px;
}

h3{color:#777;letter-spacing:2px}

.grid{
    display:grid;
    grid-template-columns:repeat(8,1fr);
    gap:6px;
    margin-bottom:15px;
}

.cell{
    border:1px solid #111;
    padding:12px 0;
    text-align:center;
    cursor:pointer;
}

.cell.on{
    background:#ff3399;
    color:#000;
}

button{
    padding:15px;
    background:#000;
    border:1px solid #333;
    color:#666;
    margin-right:10px;
}

button:hover{border-color:#555;color:#fff}
</style>
</head>

<body>

<h3>TECHNODRONE://CONSOLE</h3>

<div id="allGrids"></div>

<button onclick="togglePlay()">START / STOP</button>
<button onclick="clearGrid()">CLEAR</button>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, set, get, onValue, remove } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig={
apiKey:"AIzaSyDXZbUQ81jxiGgH89gXdoH7pf2mSxp_rN0",
authDomain:"technodrone-ce06d.firebaseapp.com",
databaseURL:"https://technodrone-ce06d-default-rtdb.firebaseio.com",
projectId:"technodrone-ce06d"
};

const app=initializeApp(firebaseConfig);
const db=getDatabase(app);

const NOTES=9;
const STEPS=8;

const container=document.getElementById("allGrids");

for(let n=0;n<NOTES;n++){
    const title=document.createElement("p");
    title.innerText="NOTE_"+n;
    container.appendChild(title);

    const grid=document.createElement("div");
    grid.className="grid";

    for(let s=0;s<STEPS;s++){
        const cell=document.createElement("div");
        cell.className="cell";
        cell.innerText=s+1;

        cell.onclick=()=>{
            const path=`techno_sequencer/grid/${n}/${s}`;
            get(ref(db,path)).then(snap=>{
                set(ref(db,path),!snap.val());
            });
        };

        onValue(ref(db,`techno_sequencer/grid/${n}/${s}`),snap=>{
            cell.classList.toggle("on",snap.val()===true);
        });

        grid.appendChild(cell);
    }

    container.appendChild(grid);
}

window.togglePlay=async function(){
    const playRef=ref(db,"techno_sequencer/playing");
    const snap=await get(playRef);
    set(playRef,!snap.val());
};

window.clearGrid=function(){
    remove(ref(db,"techno_sequencer/grid"));
};
</script>

</body>
</html>
